- var disableBackLink = false

- if ('index' == req.greppy.route.action && 'undefined' !== typeof comment)
  - disableBackLink = true

- if (!disableBackLink)

  - if ('index' != req.greppy.route.action)

    a.btn.btn-default(href="#{controller.link('index')}", title="Back to overview")
      i.icon-th-list

  - if ('new' != req.greppy.route.action)

    &nbsp;
    a.btn.btn-primary(href="#{controller.link('new')}", title="Create a new comment")
      i.icon-plus

- if ('show' == req.greppy.route.action || 'index' == req.greppy.route.action)

  - if ('undefined' !== typeof comment)

    - if ('show' != req.greppy.route.action)

      a.btn.btn-default(href="#{controller.link('show', { oid: comment.id })}", title="Show comment details")
        i.icon-search

    &nbsp;
    a.btn.btn-warning(href="#{controller.link('edit', { oid: comment.id })}", title="Edit this comment")
      i.icon-pencil

    &nbsp;

    - if (!comment.deleted_at)

      a.btn.btn-danger.delete-operation(title="Delete", data-id="#{ comment.id }")
        i.icon-trash

    - else

      a.btn.btn-success.restore-operation(title="Restore", data-id="#{ comment.id }")
        i.icon-refresh

- if ('undefined' === typeof comment || 'show' == req.greppy.route.action)

  script.

    greppy.controller = new greppy.Controller(!{JSON.stringify(controller)});

    /**
     * Delete popup bindings
     */
    $(document).on('click', '.delete-operation', function() {

      var id = $(this).attr('data-id');
      greppy.app.dialog(
        'Do you really want to delete this comment?',
        {
          ok: function(callback) {

            $.ajax({
                type: "DELETE",
                url: greppy.controller.link('destroy', {oid: id})
            }).done(function(data) {
                window.location.reload();
            });

            callback && callback();
          }
        }
      );
    });

    /**
     * Restore popup bindings
     */
    $(document).on('click', '.restore-operation', function() {

      var id = $(this).attr('data-id');
      greppy.app.dialog(
        'Do you really want to restore this comment?',
        {
          ok: function(callback) {

            $.ajax({
                type: "POST",
                url: greppy.controller.link('restore', {oid: id})
            }).done(function(data) {
                window.location.reload();
            });

            callback && callback();
          }
        }
      );
    });

